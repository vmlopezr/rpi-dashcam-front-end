<!DOCTYPE html>
<ion-header>
  <ion-toolbar  class="header" color="primary" mode="ios">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home" (click)="stopStreamServer()"></ion-back-button>
    </ion-buttons>
    <ion-title class="ion-text-center page-title">Live Streaming</ion-title>
  </ion-toolbar>
  <div ion-fixed class="livestream">
      <img [src]='getImgContent()' width="{{width}}" height="{{height}}">
      <!-- <ion-img-viewer  [src]="getImgContent()"></ion-img-viewer> -->
      <!-- <img src="assets/car.jpg" width="{{width}}" height="{{height}}"/> -->
      <!-- <ion-img-viewer  src="assets/icons/car.jpg"></ion-img-viewer> -->
    </div>
</ion-header>
<ion-content class="content-style">
  <ion-card class="card-style">
    <div>
      <div class="card-header">
        <h1 class="heading-text">Camera Settings</h1>
        <ion-button class="info-icon" fill="clear" mode="ios" color="light">
          <ion-icon name="information-circle" ></ion-icon>
        </ion-button>
      </div>
      <p class="p-text">Update the settings for video recording</p>
    </div>
    <ion-range (ionChange)="updateCameraSettings()" debounce="300" class="slider" width="100" mode="ios" min="0" max="255" [(ngModel)]="brightness">
        <ion-label color="light" slot="start" class="ion-text-wrap slider-label">Brightness</ion-label>
        <ion-label color="light" class="slider-value" slot="end">{{brightness}}</ion-label>
    </ion-range>
    <ion-range (ionChange)="updateCameraSettings()" debounce="300" class="slider"  mode="ios" min="0" max="255" [(ngModel)]="contrast">
        <ion-label color="light" slot="start" class="ion-text-wrap slider-label">Contrast</ion-label>
        <ion-label color="light" class="slider-value" slot="end" >{{contrast}}</ion-label>
    </ion-range>
    <ion-range (ionChange)="updateCameraSettings()" debounce="300" class="slider" mode="ios" min="0" max="255" [(ngModel)]="saturation">
      <ion-label color="light" slot="start" class="ion-text-wrap slider-label">Saturation</ion-label>
      <ion-label color="light" class="slider-value" slot="end" >{{saturation}}</ion-label>
    </ion-range>
    <ion-range (ionChange)="updateCameraSettings()" debounce="300" class="slider" mode="ios" min="0" max="255" [(ngModel)]="gain">
      <ion-label color="light" slot="start" class="ion-text-wrap slider-label">Gain</ion-label>
      <ion-label color="light" class="slider-value" slot="end">{{gain}}</ion-label>
    </ion-range>
    <ion-range (ionChange)="updateCameraSettings()" debounce="300" class="slider" mode="ios" min="0" max="255" [(ngModel)]="sharpness">
      <ion-label color="light" slot="start" class="ion-text-wrap slider-label">Sharpness</ion-label>
      <ion-label color="light" class="slider-value" slot="end">{{sharpness}}</ion-label>
    </ion-range>
  </ion-card>

  <ion-card class="card-style">
      <div class="card-header">
        <h1 class="heading-text">Focus Settings</h1> 
        <ion-button class="info-icon" fill="clear" mode="ios" color="light">
          <ion-icon name="information-circle" ></ion-icon>
        </ion-button>
      </div>
    <ion-item class="toggle-container">
      <ion-label class="toggle-label"color="light">Auto Focus</ion-label>
      <ion-toggle class="toggle" mode="ios" slot="start" [(ngModel)]="focusAuto" (ionChange)="updateFocusSettings()"></ion-toggle>
    </ion-item>
    <ion-range (ionChange)="updateCameraSettings()" debounce="300" step="5" pin="true" [disabled]="focusAuto" class="slider" mode="ios" min="0" max="250" [(ngModel)]="focusAbsolute">
        <ion-label color="light" slot="start"  class="ion-text-wrap slider-label">Focus Absolute</ion-label>
        <ion-label color="light" class="slider-value" slot="end" >{{focusAbsolute}}</ion-label>
    </ion-range>
  </ion-card>

  <ion-card class="card-style">
    <div class="card-header">
      <h1 class="heading-text">Exposure Settings</h1> 
      <ion-button class="info-icon" fill="clear" mode="ios" color="light">
        <ion-icon name="information-circle" ></ion-icon>
      </ion-button>
    </div>
    <ion-item class="toggle-container">
      <ion-label color="light">Auto Exposure</ion-label>
      <ion-toggle class="toggle" mode="ios" slot="start" [(ngModel)]="exposureAuto" (ionChange)="updateExposureSettings()"></ion-toggle>
    </ion-item>
    <ion-item class="toggle-container">
      <ion-label color="light">Auto Exposure Priority</ion-label>
      <ion-toggle class="toggle" mode="ios" slot="start" [(ngModel)]="exposureAutoPriority" (ionChange)="updateCameraSettings()"></ion-toggle>
    </ion-item>
    <ion-range (ionChange)="updateCameraSettings()" debounce="300" class="slider" [disabled]="exposureAuto" mode="ios" min="3" max="2047" [(ngModel)]="exposureAbsolute">
        <ion-label color="light" slot="start" class="ion-text-wrap slider-label">Exposure Absolute</ion-label>
        <ion-label color="light" class="slider-value" slot="end" >{{exposureAbsolute}}</ion-label>
    </ion-range>
  </ion-card>

  <ion-card class="card-style">
    <div class="card-header">
      <h1 class="heading-text">White Balance Settings</h1> 
      <ion-button class="info-icon" fill="clear" mode="ios" color="light">
        <ion-icon name="information-circle" ></ion-icon>
      </ion-button>
    </div>
    <ion-item class="toggle-container">
      <ion-label color="light">White Balance Temperature Auto</ion-label>
      <ion-toggle class="toggle" mode="ios" slot="start" [(ngModel)]="whiteBalanceAuto" (ionChange)="updateWhiteBalanceSettings()"></ion-toggle>
    </ion-item>
    <ion-range (ionChange)="updateCameraSettings()" debounce="300" class="slider" [disabled]="whiteBalanceAuto" mode="ios" min="2000" max="6500" [(ngModel)]="whiteBalanceTemp">
        <ion-label color="light" slot="start" class="ion-text-wrap slider-label">White Balance Temperature</ion-label>
        <ion-label color="light" class="slider-value" slot="end">{{whiteBalanceTemp}}</ion-label>
    </ion-range>
  </ion-card>

  <ion-card class="card-style">
    <div class="card-header">
      <h1 class="heading-text">Miscellaneous Settings</h1> 
      <ion-button class="info-icon" fill="clear" mode="ios" color="light">
        <ion-icon name="information-circle" ></ion-icon>
      </ion-button>
    </div>
    <ion-range (ionChange)="updateCameraSettings()" debounce="300" class="slider" mode="ios" step="3600" min="-36000" max="36000" [(ngModel)]="tiltAbsolute">
        <ion-label color="light" slot="start" class="ion-text-wrap slider-label">Tilt Absolute</ion-label>
        <ion-label color="light" class="slider-value" slot="end" >{{tiltAbsolute}}</ion-label>
    </ion-range>
    <ion-range (ionChange)="updateCameraSettings()" debounce="300" class="slider" mode="ios" min="100" max="500" [(ngModel)]="zoomAbsolute">
        <ion-label color="light" slot="start" class="ion-text-wrap slider-label">Zoom Absolute</ion-label>
        <ion-label color="light" class="slider-value" slot="end" >{{zoomAbsolute}}</ion-label>
    </ion-range>
    <ion-range (ionChange)="updateCameraSettings()" debounce="300" class="slider" mode="ios" step="3600" min="-36000" max="36000" [(ngModel)]="panAbsolute">
        <ion-label color="light" slot="start" class="ion-text-wrap slider-label">Pan Absolute</ion-label>
        <ion-label color="light" class="slider-value" slot="end" >{{panAbsolute}}</ion-label>
    </ion-range>
    <ion-range (ionChange)="updateCameraSettings()" debounce="300" class="slider" mode="ios" snaps="true" ticks="true" min="0" max="2" [(ngModel)]="powerFreq">
        <ion-label color="light" slot="start" class="ion-text-wrap slider-label" >Power Line Frequency</ion-label>
        <ion-label color="light" class="slider-value" slot="end" >{{powerFreq}}</ion-label>
    </ion-range>
    <ion-item class="toggle-container">
      <ion-label class="toggle-label" color="light">Backlight Compensation</ion-label>
      <ion-toggle  class="toggle" mode="ios" slot="start" [(ngModel)]="backlightComp"></ion-toggle>
    </ion-item>
  </ion-card>
  <ion-button class="reset-button" (click)="resetDefaults()">
    <ion-label>Reset Defaults</ion-label>
  </ion-button>
</ion-content>    
